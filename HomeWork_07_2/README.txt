Ось реалізація додаткового завдання, розділена на дві частини:

Додаткові запити підвищеної складності (оновлений my_select.py).
Повноцінна CLI програма для CRUD операцій (новий main.py з використанням argparse).
Важливо: Перед запуском цих скриптів переконайтеся, що ви виконали всі попередні кроки:
Налаштували PostgreSQL (Docker контейнер).

Створили models.py з визначеннями моделей та підключенням до БД.
Налаштували та виконали міграції Alembic (alembic init, alembic revision --autogenerate, alembic upgrade head).
Заповнили базу даних початковими даними за допомогою seed.py (це потрібно для того, щоб у базі були дані для запитів та для тестування CRUD).

Частина 1: Додаткові запити підвищеної складності
Я додав дві нові функції (select_11 та select_12) до файлу my_select.py.
my_select.py - Розширені SQLAlchemy ORM запити

Пояснення до нових запитів:

select_11 (Середній бал, який певний викладач ставить певному студентові):
Об'єднує таблиці Grade, Student, Subject та Teacher.
Фільтрує за повним ім'ям студента та повним ім'ям викладача.
Групує за студентом та викладачем, щоб обчислити середній бал.

select_12 (Оцінки студентів у певній групі з певного предмета на останньому занятті):
Це більш складний запит, що використовує підзапит (subquery).
Внутрішній підзапит (subquery): Знаходить максимальну (найпізнішу) дату оцінки (max_grade_date) для кожного student_id та subject_id.
Основний запит: Об'єднує Grade, Student, Group, Subject та результат subquery.
Фільтрує за назвою групи та назвою предмета.
Умова JOIN з підзапитом гарантує, що ми вибираємо лише ті оцінки, дата яких відповідає максимальній даті для даного студента та предмета.

Частина 2: CLI програма для CRUD операцій (main.py)
Цей файл замінить попередній main.py та seed.py для інтерактивного керування базою даних через командний рядок.
main.py - CLI CRUD програма

Пояснення до main.py (CLI CRUD програма):
argparse: Модуль використовується для парсингу аргументів командного рядка.
--action (-a): Обов'язковий аргумент, що визначає CRUD операцію (create, list, update, remove).
--model (-m): Обов'язковий аргумент, що визначає модель, над якою виконується операція (Group, Teacher, Subject, Student, Grade).
--id (-id): Використовується для операцій update та remove для вказівки ID запису.
--name (-n): Використовується для create та update для полів name або fullname (для Group, Teacher, Student, Subject).
--fullname: Альтернативний аргумент для --name для Teacher та Student.

Додаткові аргументи (--group_id, --teacher_id, --student_id, --subject_id, --grade, --grade_date) для специфічних моделей.
Функції CRUD (create_record, list_records, update_record, remove_record):
Кожна функція приймає клас моделі та відповідні аргументи.
Вони використовують SQLAlchemy сесію для взаємодії з базою даних.
Реалізовано логіку для створення, виведення, оновлення та видалення записів для кожної моделі.
Включено базову перевірку вхідних даних (наприклад, наявність пов'язаних ID).
Використовується try...except...finally для обробки помилок та забезпечення session.rollback() у разі невдачі та session.close() після кожної операції.
get_model_class(model_name): Допоміжна функція для отримання класу моделі за її строковим ім'ям.

main() функція:
Парсить аргументи командного рядка.
Визначає, яку дію та для якої моделі потрібно виконати.
Викликає відповідну CRUD функцію.
Включає перевірки на обов'язкові аргументи для кожної дії та моделі.
Приклади виконання команд у терміналі (запускати з кореневого каталогу проєкту):

Створити вчителя:
python main.py -a create -m Teacher -n 'Марія Коваленко'

Створити групу:
python main.py -a create -m Group -n 'AD-202'

Створити предмет (потрібен ID викладача, який вже існує, наприклад, ID 1):
python main.py -a create -m Subject -n 'Веб-розробка' --teacher_id 1

Створити студента (потрібен ID групи, яка вже існує, наприклад, ID 1):
python main.py -a create -m Student -n 'Олександр Петров' --group_id 1

Створити оцінку (потрібен ID студента, предмета, наприклад, Student ID 1, Subject ID 1):
python main.py -a create -m Grade --student_id 1 --subject_id 1 --grade 95 --grade_date '2023-01-15'

Показати всіх викладачів:
python main.py -a list -m Teacher

Показати всіх студентів:
python main.py -a list -m Student

Оновити дані викладача з id=3:
python main.py -a update -m Teacher -id 3 -n 'Андрій Безос'

Видалити групу з id=2:
python main.py -a remove -m Group -id 2
(Будьте обережні при видаленні, якщо є пов'язані записи, може знадобитися каскадне видалення або ручне видалення залежностей.)

Ці файли та інструкції повинні дозволити вам виконати всі вимоги додаткового завдання.